---
import type { Language } from '@/i18n/config'
import Button from '@/components/Button.astro'
import Footer from '@/components/Footer.astro'
import Header from '@/components/Header.astro'
import Navbar from '@/components/Navbar.astro'
import CodeCopyButton from '@/components/Widgets/CodeCopyButton.astro'
import GithubCard from '@/components/Widgets/GithubCard.astro'
import ImageZoom from '@/components/Widgets/ImageZoom.astro'
import MediaEmbed from '@/components/Widgets/MediaEmbed.astro'
import SoundEffect from '@/components/Widgets/SoundEffect.astro'
import { allLocales, themeConfig } from '@/config'
import Head from './Head.astro'
import '@/styles/global.css'
import '@/styles/font.css'
import '@/styles/markdown.css'
import '@/styles/transition.css'
import '@/styles/lqip.css'
import '@/styles/comment.css'
import '@/styles/extension.css'

interface Props {
  description?: string
  image?: string
  title?: string
  post?: any
  postTitle?: string
  postDescription?: string
  postSlug?: string
  supportedLangs?: Language[]
}

const { description, image, title, post, postTitle, postDescription, postSlug, supportedLangs: propSupportedLangs } = Astro.props
const lang = Astro.currentLocale as Language
const { reduceMotion } = themeConfig.global

// Margin Bottom for Main Content
const MarginBottom = post || postTitle ? 'mb-20 lg:mb-30' : 'mb-30 lg:mb-40'

// Use provided supportedLangs or fallback to allLocales
// This ensures the language switcher only shows languages where content exists
const supportedLangs = propSupportedLangs && propSupportedLangs.length > 0 ? propSupportedLangs : allLocales
---

<!doctype html>
<html lang={lang} class:list={['scrollbar-hidden', { 'reduce-motion': reduceMotion }]}>
  <head>
    <Head title={title} description={description} image={image} post={post} />
  </head>
  <body>
    <div
      class="relative mx-auto max-w-205.848 min-h-vh w-full min-h-dvh px-[min(7.25vw,3.731rem)] py-10 lg:mx-[max(5.75rem,calc(50vw-34.25rem))] lg:my-20 lg:max-w-[min(calc(75vw-16rem),44rem)] lg:min-h-full lg:p-0"
    >
      <Header />
      <Navbar />
      <main class={MarginBottom}>
        <slot />
      </main>
      <Footer />
    </div>
    <Button supportedLangs={supportedLangs} />
    <SoundEffect />
    <CodeCopyButton />
    <GithubCard />
    <MediaEmbed />
    <ImageZoom />
  </body>
</html>
